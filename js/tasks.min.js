const DH=8,WDHMS=7,YMDHMS=6,MDHMS=5,DHMS=4,HMS=3,MS=2,S=1,NOT_COMPACT="notCompact",COMPACT="compact",ULTRA_COMPACT="ultraCompact",ULTRA_COMPACT_WITH_BUTTONS="ultraCompactWithButtons";var compactType=getCompact(),intervalTimer=setInterval((function(){updateEverything()}),UPDATE_TIME),allEvents=[],currentFormat=getFormat(),weeksLeft=0,yearsLeft=0,monthsLeft=0,daysLeft=0,hoursLeft=0,minutesLeft=0,secondsLeft=0,FUTURE_EVENTS=1,PAST_EVENTS=2,ALL_EVENTS=3,pastEventIndexes=[],futureEventIndexes=[],currentEventsType=ALL_EVENTS,eventMoment=null,currentMoment=null,diff=null,timer=null;allEvents=getAllEvents();var timeElements=null,endTimeElements=null,percentElements=null,indexesArray=getCorrectIndexArray(currentEventsType);checkAndDisplayEvents(currentEventsType),updateEventStatistics();var visibleElements=[];visibleElements=checkVisibleEvents();var pageTitleKey="tasksTitle";loadPageTitle(pageTitleKey);var tempDisplayIndex=0,tempEvent=null,tempDateString=null,tempEventDate=null,tempEventEndDate=null,tempEndDateString=null,tempForButtons=99,doCategoriesExist=checkForCategory();function Event(e,t,n){this.name=e,this.dateTime=t,this.notifications=n}function updateEverything(){updateCurrentTime(),updateVisibleEvents(currentFormat),checkAllNotifications()}function checkAndDisplayEvents(e){1==checkForCategory()?displayEventsWithCategories(e):displayAllEvents(e)}function checkForCategory(){for(const e of allEvents)if(null!=e.category)return!0;return!1}function getAllUniqueCategories(){let e=[],t=[];for(let n=0;n<allEvents.length;n++){let s=allEvents[n].category;t.push({eventCategory:n}),e.includes(s)||e.push(s)}return e.sort(),e}function createCategoryHtml(e){let t=`table_${e}`;document.getElementById("events_container").innerHTML+=`${e}`,document.getElementById("events_container").innerHTML+=`<table id="${t}"><tr><th>#</th><th>Event Name</th></tr></table>`,document.getElementById("events_container").innerHTML+="<br>";for(let n=0;n<allEvents.length;n++)if(allEvents[n].category==e){tempEvent=allEvents[n],tempDisplayIndex=n,tempDateString=tempEvent.dateTime,tempEventDate=returnCorrectDate(tempDateString),tempEndDateString=tempEvent.endDateTime,tempEventEndDate=null,tempForButtons=n;let e=ultraCompactTable(t);document.getElementById(t).appendChild(e)}}function displayEventsWithCategories(e){setEventType(e),deleteClassChildItems("an_event"),document.getElementById("events_container").innerHTML="";const t=getAllUniqueCategories();for(let e of t)createCategoryHtml(e);timeElements=document.getElementsByClassName("timeUntil"),endTimeElements=document.getElementsByClassName("endTimeUntil"),percentElements=document.getElementsByClassName("percent")}function displayAllEvents(e){switch(compactType){case"ultraCompactWithButtons":document.getElementById("events_container").innerHTML='<table id="users_events"><tr><th>#</th><th>Event Name</th></tr></table>';break;case ULTRA_COMPACT:document.getElementById("events_container").innerHTML='<table id="users_events"><tr><th>#</th><th>Event Name</th></tr></table>';break;default:document.getElementById("events_container").innerHTML='<div id="users_events"></div>'}setEventType(e),deleteClassChildItems("an_event");let t=allEvents.length;switch(e){case FUTURE_EVENTS:t=(futureEventIndexes=findFutureOrPastEvents(FUTURE_EVENTS)).length;break;case PAST_EVENTS:t=(pastEventIndexes=findFutureOrPastEvents(PAST_EVENTS)).length;break;default:}indexesArray=getCorrectIndexArray(currentEventsType);for(let n=0;n<t;n++){switch(e){case FUTURE_EVENTS:tempEvent=allEvents[futureEventIndexes[n]],tempDisplayIndex=futureEventIndexes[n];break;case PAST_EVENTS:tempEvent=allEvents[pastEventIndexes[n]],tempDisplayIndex=pastEventIndexes[n];break;default:tempEvent=allEvents[n],tempDisplayIndex=n}tempDateString=tempEvent.dateTime,tempEventDate=returnCorrectDate(tempDateString),tempEndDateString=tempEvent.endDateTime,tempEventEndDate=null;let t=!1;void 0!==tempEndDateString&&(t=!0,tempEventEndDate=returnCorrectDate(tempEndDateString));let s=null;switch(compactType){case"ultraCompactWithButtons":s=createUltraCompactElementWithButtons();break;case ULTRA_COMPACT:s=createUltraCompactElement();break;case COMPACT:s=createCompactElement();break;default:s=createNonCompactElement()}document.getElementById("users_events").appendChild(s)}timeElements=document.getElementsByClassName("timeUntil"),endTimeElements=document.getElementsByClassName("endTimeUntil"),percentElements=document.getElementsByClassName("percent")}function ultraCompactTable(e){const t=tempForButtons,n=document.createElement("tr");n.classList.add("an_event");const s=document.getElementById(e).insertRow(-1),a=document.createElement("button");a.innerText="E",a.classList.add("event_button"),a.setAttribute("onclick",`exportEvent(${t});`);const r=document.createElement("button");r.innerHTML="EaD",r.classList.add("event_button"),r.setAttribute("onclick",`exportEvent(${t}); deleteEvent(${t});`);const l=document.createElement("button");l.innerHTML="D",l.classList.add("event_button"),l.setAttribute("onclick",`deleteEvent(${t});`);const i=document.createElement("button");i.innerHTML="R",i.classList.add("event_button"),i.setAttribute("onclick",`resetFromNow(${t});`);const o=document.createElement("button");o.innerHTML="R9",o.classList.add("event_button"),o.setAttribute("onclick",`resetToNineAm(${t});`);const c=document.createElement("button");c.innerHTML="M",c.classList.add("event_button"),c.setAttribute("onclick",`modifyEvent(${t});`);const d=document.createElement("button");d.innerHTML="+1D",d.classList.add("event_button"),d.setAttribute("onclick",`addSubOneDay("${t}", "add");`);const m=document.createElement("button");m.innerHTML="-1D",m.classList.add("event_button"),m.setAttribute("onclick",`addSubOneDay("${t}", "sub");`);const u=document.createElement("button");u.innerHTML="SR",u.classList.add("event_button"),u.setAttribute("onclick",`smartReset(${t});`);s.insertCell(-1).innerHTML=`${t+1}`;if(s.insertCell(-1).innerHTML=`${tempEvent.name}`,null!=allEvents[t].daysBeforeRepeat){const e=s.insertCell(-1);e.id=`overdueTimes_${t}`,e.innerText="0";const n=s.insertCell(-1);n.id=`eventOverdue_${t}`,n.innerText="no";s.insertCell(-1).innerText=allEvents[t].daysBeforeRepeat}const E=s.insertCell(-1);E.id=`time_${t}`,E.classList.add("timeUntil"),E.classList.add("ultraCompactTimeUntil"),E.innerText="---";s.insertCell(-1).appendChild(a);s.insertCell(-1).appendChild(r);s.insertCell(-1).appendChild(l);s.insertCell(-1).appendChild(i);s.insertCell(-1).appendChild(o);s.insertCell(-1).appendChild(c);s.insertCell(-1).appendChild(d);if(s.insertCell(-1).appendChild(m),null!=allEvents[t].smartResetDay){s.insertCell(-1).appendChild(u)}return n}function createUltraCompactElementWithButtons(){const e=tempDisplayIndex,t=document.createElement("tr");t.classList.add("an_event");const n=document.getElementById("users_events").insertRow(-1),s=document.createElement("button");s.innerHTML="E",s.classList.add("event_button"),s.onclick=function(){exportEvent(e)};const a=document.createElement("button");a.innerHTML="EaD",a.classList.add("event_button"),a.onclick=function(){exportEvent(e),deleteEvent(tempDisplayIndex)};const r=document.createElement("button");r.innerHTML="D",r.classList.add("event_button"),r.onclick=function(){deleteEvent(e)};const l=document.createElement("button");l.innerHTML="R",l.classList.add("event_button"),l.onclick=function(){resetFromNow(e)};const i=document.createElement("button");i.innerHTML="M",i.classList.add("event_button"),i.onclick=function(){modifyEvent(e)};n.insertCell(-1).innerHTML=`${tempDisplayIndex+1}`;if(n.insertCell(-1).innerHTML=`${tempEvent.name}`,null!=allEvents[tempDisplayIndex].daysBeforeRepeat){const e=n.insertCell(-1);e.id=`overdueTimes_${tempDisplayIndex}`,e.innerText="0";const t=n.insertCell(-1);t.id=`eventOverdue_${tempDisplayIndex}`,t.innerText="no";n.insertCell(-1).innerText=allEvents[tempDisplayIndex].daysBeforeRepeat}const o=n.insertCell(-1);o.id=`time_${tempDisplayIndex}`,o.classList.add("timeUntil"),o.classList.add("ultraCompactTimeUntil"),o.innerText="---";n.insertCell(-1).appendChild(s);n.insertCell(-1).appendChild(a);n.insertCell(-1).appendChild(r);n.insertCell(-1).appendChild(l);return n.insertCell(-1).appendChild(i),t}function createUltraCompactElement(){const e=document.createElement("tr");e.classList.add("an_event");const t=document.getElementById("users_events").insertRow(-1);t.insertCell(-1).innerHTML=`${tempDisplayIndex+1}`;t.insertCell(-1).innerHTML=`${tempEvent.name}`;const n=t.insertCell(-1);return n.id=`time_${tempDisplayIndex}`,n.classList.add("timeUntil"),n.classList.add("ultraCompactTimeUntil"),n.innerText="---",e}function createCompactElement(){let e=document.createElement("fieldset");e.classList.add("an_event");const t=document.createElement("legend"),n=document.createTextNode(`(${tempDisplayIndex+1}) ${tempEvent.name}`);t.appendChild(n),e.appendChild(t);const s=document.createElement("div");s.classList.add("index"),e.appendChild(s);const a=document.createElement("div");a.classList.add("timeUntil"),a.id=`time_${tempDisplayIndex}`,a.innerHTML="---",e.appendChild(a);const r=document.createElement("div"),l=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");i.classList.add("endTimeUntil"),o.classList.add("percent"),e.appendChild(r),e.appendChild(l),e.appendChild(i),e.appendChild(o);const c=document.createElement("br");c.classList.add("an_event");const d=document.createElement("div");return d.appendChild(e),d.appendChild(c),d}function createNonCompactElement(){const e=tempDisplayIndex;let t=document.createElement("fieldset");t.classList.add("an_event");const n=document.createElement("legend"),s=document.createTextNode(`(${e+1}) ${tempEvent.name}`);n.appendChild(s),t.appendChild(n);const a=document.createElement("div");a.classList.add("index"),t.appendChild(a);const r=document.createElement("div"),l=twelveHourTime(tempEventDate);r.innerHTML=`Date: ${tempDateString} (${l})`,t.appendChild(r);const i=document.createElement("div");i.innerHTML=`Expanded: ${tempEventDate.toString()}`,t.appendChild(i);const o=document.createElement("div");o.classList.add("timeUntil"),o.id=`time_${e}`,o.innerHTML="---",t.appendChild(o);const c=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div"),u=document.createElement("div");m.classList.add("endTimeUntil"),u.classList.add("percent"),t.appendChild(c),t.appendChild(d),t.appendChild(m),t.appendChild(u);const E=document.createElement("div");E.innerHTML=`Notifications: ${tempEvent.notifications}`,t.appendChild(E);const v=document.createElement("button");v.innerHTML="Export",v.classList.add("event_button"),v.onclick=function(){exportEvent(e)},t.appendChild(v);const p=document.createElement("button");p.innerHTML="Export and Delete",p.classList.add("event_button"),p.onclick=function(){exportEvent(e),deleteEvent(tempDisplayIndex)},t.appendChild(p);const f=document.createElement("button");f.innerHTML="Delete",f.classList.add("event_button"),f.onclick=function(){deleteEvent(e)},t.appendChild(f);const T=document.createElement("button");T.innerHTML="Reset From Now",T.classList.add("event_button"),T.onclick=function(){resetFromNow(e)},t.appendChild(T);const _=document.createElement("button");_.innerHTML="Modify Event",_.classList.add("event_button"),_.onclick=function(){modifyEvent(e)},t.appendChild(_);const N=document.createElement("br");N.classList.add("an_event");const C=document.createElement("div");return C.appendChild(t),C.appendChild(N),C}function updateEventStatistics(){let e=0,t=0;for(const n of allEvents)hasEventPassed(returnCorrectDate(n.dateTime))?e+=1:t+=1;document.getElementById("statistics_div").innerText=`Total number of events: ${allEvents.length}\nPassed: ${e}\nUpcoming: ${t}\nPercent completed: ${(e/(e+t)*100).toFixed(2)}`}function addEvent(){const e=document.forms.eventForm.name.value,t=document.forms.eventForm.dateTime.value;let n=document.forms.eventForm.notifications.value.split(",");null!=n&&""!=n||(n=[0]),allEvents.push(new Event(e,t,n)),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics()}function quickAdd(e){const t=document.forms.quickAddForm.name.value;let n=new Date(now);n.setMinutes(n.getMinutes()+e),allEvents.push(new Event(t,convertDateToString(n),[0])),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics()}function convertDateToString(e){return`${e.getFullYear()}-${padNumber(e.getMonth()+1)}-${padNumber(e.getDate())} ${padNumber(e.getHours())}:${padNumber(e.getMinutes())}:${padNumber(e.getSeconds())}`}function saveEvents(){localStorage.setItem("allTasks",JSON.stringify(allEvents))}function deleteEvent(e){window.confirm(`Delete event ${e+1} (${allEvents[e].name})?`)&&(allEvents.splice(e,1),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics())}function exportEvent(e){let t=allEvents[e];for(let e of Object.keys(t)){JSON.stringify(e).startsWith('"notificationTriggered')&&delete t[e]}const n=JSON.stringify(allEvents[e]);prompt("Copy this text",n)}function modifyEvent(e){const t=prompt("Modify this text",JSON.stringify(allEvents[e]));null!=t&&(allEvents[e]=JSON.parse(t),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics())}function setEventType(e){indexesArray=getCorrectIndexArray(currentEventsType=1===e?FUTURE_EVENTS:2===e?PAST_EVENTS:ALL_EVENTS)}function findFutureOrPastEvents(e){const t=[];for(let n=0;n<allEvents.length;n++){const s=new Date(allEvents[n].dateTime),a=hasEventPassed(s);e!==FUTURE_EVENTS||a||t.push(n),e===PAST_EVENTS&&a&&t.push(n)}return t}function changeCompact(){const e=document.getElementById("compact_picker").value;localStorage.setItem("tasksCompactType",e),compactType=getCompact(),checkAndDisplayEvents(currentEventsType)}function getCompact(){const e="tasksCompactType",t=localStorage.getItem(e);return null!=t?t:(localStorage.removeItem(e),localStorage.setItem(e,"ultraCompactWithButtons"),NOT_COMPACT)}function sortEvents(e){1===e?allEvents.sort(((e,t)=>returnCorrectDate(e.dateTime)-returnCorrectDate(t.dateTime))):allEvents.sort(((e,t)=>returnCorrectDate(t.dateTime)-returnCorrectDate(e.dateTime))),saveEvents(),checkAndDisplayEvents(currentEventsType)}function returnCorrectDate(e){return/^[0-9]{8}T[0-9]{6}Z$/.test(e)?moment(e,"YYYYMMDDTHHmmssZ").toDate():new Date(e)}function getCorrectIndexArray(e){switch(e){case ALL_EVENTS:return[...allEvents];case FUTURE_EVENTS:return[...futureEventIndexes];case PAST_EVENTS:return[...pastEventIndexes];default:return[...allEvents]}}function checkAllNotifications(){if("enabled"===getNotificationStatus())for(const e of allEvents){const t=calcTimesOverdue(e),n=e.name;if(null==e.timesOverdue)e.timesOverdue=t,saveEvents();else if(e.timesOverdue>t)e.timesOverdue=t,saveEvents();else if(e.timesOverdue<t){createNotification(`"${n}" is overdue`,`new: ${t}, old: ${e.timesOverdue}`,!0),e.timesOverdue=t,saveEvents()}}}function checkVisibleEvents(){visibleElements=[];const e=[];let t="";for(let n=0;n<indexesArray.length;n++)t=currentEventsType===ALL_EVENTS?`time_${n}`:`time_${indexesArray[n]}`,isElementVisible(document.getElementById(t))&&e.push(n);return null==e?[]:e}function updateVisibleEvents(e){if(null==visibleElements)return;let t="",n="";for(let s=0;s<visibleElements.length;s++){const a=currentEventsType==ALL_EVENTS?allEvents[visibleElements[s]]:allEvents[indexesArray[s]],r=currentEventsType==ALL_EVENTS?visibleElements[s]:indexesArray[s],l=returnCorrectDate(a.dateTime),i=a.endDateTime,o=getMsFromNowUntilDate(l),c=hasEventPassed(l),d=document.getElementById(`time_${r}`);if(setTimeLeft(l,e,o),c?(n="Passed:",d.style.color=PASSED_COLOR):(n="Upcoming:",d.style.color=UPCOMING_COLOR),setInnerText(d,e,n),void 0!==i){const s=returnCorrectDate(i),a=hasEventPassed(s);n=a?"Passed:":"Upcoming:";const o=getMsFromNowUntilDate(s);setTimeLeft(s,e,o),setInnerText(endTimeElements[r],e,n);const c=Math.abs(l.getTime()-s.getTime()),d=(c-o)/c*100;t=d>100||d<0||a?"--- finished, --- left":`${d.toFixed(3)} % finished, ${(100-d).toFixed(3)} % left`;try{percentElements[r].innerText=t}catch(e){}}const m=document.getElementById(`eventOverdue_${r}`);if(null!=m){const e=calcTimesOverdue(a);let t=!1;e>0&&(t=!0,m.style.color="red");document.getElementById(`overdueTimes_${r}`).innerText=e,m.innerText=t}}}function calcTimesOverdue(e){let t=returnCorrectDate(e.dateTime);const n=parseInt(e.daysBeforeRepeat,10);t.setDate(t.getDate()+n);let s=0;if(new Date>t){s++;for(let e=1;e<9&&(t.setDate(t.getDate()+n),new Date>t);e++)s++}return s}function setInnerText(e,t,n){const s=compactType==ULTRA_COMPACT||"ultraCompactWithButtons"==compactType;switch(t){case 8:e.innerHTML=s?`${daysLeft} d, ${hoursLeft} hr`:`${n} ${daysLeft} days, ${hoursLeft} hours`;break;case 7:e.innerHTML=s?`${weeksLeft} wk, ${daysLeft} d, ${hoursLeft} hr, ${minutesLeft} min, ${secondsLeft} sec`:`${n} ${weeksLeft} weeks, ${daysLeft} days, ${hoursLeft} hours, ${minutesLeft} minutes, ${secondsLeft} seconds`;break;case 6:e.innerText=s?`${yearsLeft} yr, ${monthsLeft} mon, ${daysLeft} d, ${hoursLeft} hr, ${minutesLeft} min, ${secondsLeft} sec`:`${n} ${yearsLeft} years, ${monthsLeft} months, ${daysLeft} days, ${hoursLeft} hours, ${minutesLeft} minutes, ${secondsLeft} seconds`;break;case 5:e.innerText=s?`${monthsLeft} mon, ${daysLeft} d, ${hoursLeft} hr, ${minutesLeft} min, ${secondsLeft} sec`:`${n} ${monthsLeft} months, ${daysLeft} days, ${hoursLeft} hours, ${minutesLeft} minutes, ${secondsLeft} seconds`;break;case 4:e.innerText=s?`${daysLeft} d, ${hoursLeft} hr, ${minutesLeft} min, ${secondsLeft} sec`:`${n} ${daysLeft} days, ${hoursLeft} hours, ${minutesLeft} minutes, ${secondsLeft} seconds`;break;case 3:e.innerText=s?`${hoursLeft} hr, ${minutesLeft} min, ${secondsLeft} sec`:`${n} ${hoursLeft} hours, ${minutesLeft} minutes, ${secondsLeft} seconds`;break;case 2:e.innerText=s?`${minutesLeft} min, ${secondsLeft} sec`:`${n} ${minutesLeft} minutes, ${secondsLeft} seconds`;break;case 1:e.innerText=s?`${secondsLeft} sec`:`${n} ${secondsLeft} seconds`;break;default:e.innerText="Error"}}function clearEvents(){window.confirm(`Delete all ${allEvents.length} events?`)&&(localStorage.removeItem("allTasks"),localStorage.setItem("allTasks","[]"),allEvents=getAllEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics())}function exportEvents(e){let t=allEvents;for(let e of t)for(let t of Object.keys(e)){JSON.stringify(t).startsWith('"notificationTriggered')&&delete e[t]}1===e?prompt("Copy this text",JSON.stringify(t)):alert(JSON.stringify(t,null,2))}function importEvents(){const e=prompt("Enter the text to import");null==e||""==e?alert("INVALID INPUT"):(localStorage.removeItem("allTasks"),localStorage.setItem("allTasks",e),allEvents=getAllEvents(),checkAndDisplayEvents(currentEventsType))}function importEvent(){const e=prompt("Enter the event's JSON string {...}");if(null==e||""==e)alert("INVALID INPUT");else{const t=getAllEvents();t.push(JSON.parse(e)),localStorage.setItem("allTasks",JSON.stringify(t)),allEvents=getAllEvents(),checkAndDisplayEvents(currentEventsType)}}function changeFormat(){switch(parseInt(document.getElementById("format_picker").value)){case 8:currentFormat=8;break;case 7:currentFormat=7;break;case 6:currentFormat=6;break;case 5:currentFormat=5;break;case 4:currentFormat=4;break;case 3:currentFormat=3;break;case 2:currentFormat=2;break;case 1:currentFormat=1;break;default:currentFormat=6}currentFormat=parseInt(currentFormat,10),localStorage.setItem("currentFormat",currentFormat)}function getFormat(){let e=localStorage.getItem("currentFormat");return null==e&&(e=8),parseInt(e,10)}function setTimeLeft(e,t,n){switch(t){case 8:n-=(daysLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR/HOURS_IN_DAY))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR*HOURS_IN_DAY,hoursLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR);break;case 7:n-=(weeksLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR/HOURS_IN_DAY/DAYS_IN_WEEK))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR*HOURS_IN_DAY*DAYS_IN_WEEK,n-=(daysLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR/HOURS_IN_DAY))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR*HOURS_IN_DAY,n-=(hoursLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR,n-=(minutesLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE))*MS_IN_SECOND*SEC_IN_MINUTE,secondsLeft=Math.floor(n/MS_IN_SECOND);break;case 5:eventMoment=moment(e),currentMoment=moment(now),diff=moment.preciseDiff(eventMoment,currentMoment,!0),monthsLeft=diff.months+diff.years*MONTHS_IN_YEAR,daysLeft=diff.days,hoursLeft=diff.hours,minutesLeft=diff.minutes,secondsLeft=diff.seconds;break;case 4:n-=(daysLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR/HOURS_IN_DAY))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR*HOURS_IN_DAY,n-=(hoursLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR,n-=(minutesLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE))*MS_IN_SECOND*SEC_IN_MINUTE,secondsLeft=Math.floor(n/MS_IN_SECOND);break;case 3:n-=(hoursLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE/MIN_IN_HOUR))*MS_IN_SECOND*SEC_IN_MINUTE*MIN_IN_HOUR,n-=(minutesLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE))*MS_IN_SECOND*SEC_IN_MINUTE,secondsLeft=Math.floor(n/MS_IN_SECOND);break;case 2:n-=(minutesLeft=Math.floor(n/MS_IN_SECOND/SEC_IN_MINUTE))*MS_IN_SECOND*SEC_IN_MINUTE,secondsLeft=Math.floor(n/MS_IN_SECOND);break;case 1:secondsLeft=Math.floor(n/MS_IN_SECOND);break;default:eventMoment=moment(e),currentMoment=moment(now),diff=moment.preciseDiff(eventMoment,currentMoment,!0),yearsLeft=diff.years,monthsLeft=diff.months,daysLeft=diff.days,hoursLeft=diff.hours,minutesLeft=diff.minutes,secondsLeft=diff.seconds}}function getAllEvents(){const e="allTasks";let t=localStorage.getItem(e);return null==t&&(localStorage.removeItem(e),localStorage.setItem(e,"[]"),t=localStorage.getItem(e)),JSON.parse(t)}function resetFromNow(e){window.confirm(`Reset event ${e+1} (${allEvents[e].name}) to the current time?`)&&(allEvents[e].dateTime=convertDateToString(now),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics())}function resetToNineAm(e){if(!window.confirm(`Reset event ${e+1} (${allEvents[e].name}) to 9 am of the current day?`))return;let t=new Date;t.setHours(9),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),allEvents[e].dateTime=convertDateToString(t),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics()}function addSubOneDay(e,t){const n=new Date(allEvents[e].dateTime);window.confirm(`Perform operation on event ${parseInt(e)+1} (${allEvents[e].name})?`)&&("add"==t?n.setDate(n.getDate()+1):"sub"==t&&n.setDate(n.getDate()-1),allEvents[e].dateTime=convertDateToString(n),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics())}function smartReset(e){const t=allEvents[e].daysBeforeRepeat,n=allEvents[e].smartResetDay;if(!window.confirm(`Smart reset to ${n} for ${parseInt(e)+1} (${allEvents[e].name})?`))return;if(!["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].includes(n))return void alert("smartResetDay is not valid");let s=new Date;for(s.setDate(s.getDate()+1);s.toLocaleString("en-us",{weekday:"long"})!==n;)s.setDate(s.getDate()+1);s.setDate(s.getDate()-t),s.setHours(9),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0),allEvents[e].dateTime=convertDateToString(s),saveEvents(),checkAndDisplayEvents(currentEventsType),updateEventStatistics()}window.addEventListener("scroll",(function(){null!==timer&&clearTimeout(timer),timer=setTimeout((function(){visibleElements=checkVisibleEvents()}),100)}),!1);